<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>⚠️ Browsing Safely?</title>
    <meta name="description" content="Shaffan Aleem | Ibn Aleem">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">
    <link rel="me" href="https://fosstodon.org/@ibnaleem">
    <script src="status.js" defer></script>
</head>

<body>
    <div class="content">
        <h3>⚠️ Are You Browsing Safely?
            <script>
                fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        const ipAddress = data.ip;
                        fetch(`https://api.iplocation.net/?ip=${ipAddress}`)
                            .then(response => response.json())
                            .then(data => { // Corrected this line
                                const country = data.country_name;
                                const isp = data.isp;

                                document.getElementById('ip-address').innerHTML = ipAddress;
                                document.getElementById('country-name').innerHTML = country;
                                document.getElementById('isp').innerHTML = isp;
                            });
                    })
                    .catch(error => {
                        console.log('Error:', error);
                    });

                fetch('https://api.github.com/repos/ibnaleem/shaffan.dev/commits?per_page=1')
                    .then(res => res.json())
                    .then(res => {
                        let commit = res[0].sha.toString();
                        let slicedCommit = commit.slice(0, 7);

                        let dateStr = res[0].commit.committer.date.toString();
                        let date = new Date(dateStr);

                        let year = date.getUTCFullYear();
                        let month = String(date.getUTCMonth() + 1).padStart(2, '0');
                        let day = String(date.getUTCDate()).padStart(2, '0');
                        let hours = String(date.getUTCHours()).padStart(2, '0');
                        let minutes = String(date.getUTCMinutes()).padStart(2, '0');
                        let seconds = String(date.getUTCSeconds()).padStart(2, '0');

                        let formattedDate = `${year}-${month}-${day} @ ${hours}:${minutes}:${seconds}`;

                        document.getElementById('latest-commit').innerHTML = `<a href="status.html">Latest Commit: ${slicedCommit} on ${formattedDate}</a><br><a href="/" noreferrer=""><< Back to home</a> | <a href="https://github.com/ibnaleem", noreferrer="">GitHub</a> | <a href="https://www.linkedin.com/in/shaffan-aleem-b7a852255/", noreferrer="">LinkedIn</a> | <a href="pgp.txt", noreferrer="">PGP Keys</a> | <a href="https://fosstodon.org/@ibnaleem", noreferrer="">Fosstodon</a>`;
                    });
            </script>
            <span id="latest-commit">...</span>
        </h3>
        <h4>IP Address</h4>
        <div>
            <ul>
                <li><code id="ip-address"></code></li>
            </ul>
        </div>
        <h4>Country Name</h4>
        <div>
            <ul>
                <li><code id="country-name"></code></li>
            </ul>
        </div>
        <h4>Internet Service Provider (ISP)</h4>
        <div>
            <ul>
                <li><code id="isp"></code></li>
            </ul>
        </div>
    </div>
</body>

</html>